<!DOCTYPE html>
<html>

<head>
  <title>Lunar Shop Stalker</title>
</head>
<link rel="stylesheet" href="/Lunar Store Scraper/styles.css">
<body>
  <h1>Welcome to my page! This project was started at 23:00 UTC on June 18th 2024</h1>
  <p><strong>This is a list of people who have purchased cosmetics on store.lunarclient.com</strong></p>
  <p>This list updates every minute or so</p>
  <p>Top is oldest and bottom is newest</p>
  <div class="container">
    <div class="table-wrapper">
      <table id="purchaseTable">
        <thead>
          <tr>
            <th>Name</th>
            <th>Time</th>
          </tr>
        </thead>
        <tbody>
          <!-- Rows will be dynamically inserted here -->
        </tbody>
      </table>
    </div>
  </div>
  <meta http-equiv="refresh" content="60" />
  <script>
    const worker = new Worker('fetchWorker.js');

    worker.onmessage = function(event) {
      if (event.data.status === 'success') {
        const nameList = event.data.names.trim().split('\n');
        const timeList = event.data.times.trim().split('\n');
        const tbody = document.querySelector('#purchaseTable tbody');
        tbody.innerHTML = ''; // Clear existing rows
        for (let i = 0; i < nameList.length; i++) {
          const row = document.createElement('tr');
          const nameCell = document.createElement('td');
          const timeCell = document.createElement('td');
          nameCell.textContent = nameList[i];
          timeCell.textContent = timeList[i];
          row.appendChild(nameCell);
          row.appendChild(timeCell);
          tbody.appendChild(row);
        }
        document.title = `Lunar Shop Stalker - ${nameList.length} Users Stored`;
      } else {
        console.error('Error fetching data:', event.data.message);
      }
    };

    function fetchAndUpdateTable() {
      worker.postMessage({});
    }

    // Fetch and update the table initially
    fetchAndUpdateTable();

    // Refresh the data every minute
    setInterval(fetchAndUpdateTable, 60000);

</script>
</body>
</html>
